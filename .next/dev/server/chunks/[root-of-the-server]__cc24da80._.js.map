{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/carlo/Documents/Enter%20tech%20school/modulo301/atix-smartmail-ia/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: [\"error\", \"warn\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;QAAS;KAAO;AACxB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/carlo/Documents/Enter%20tech%20school/modulo301/atix-smartmail-ia/pages/api/emails/index.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from \"next\";\nimport { prisma } from \"@/lib/prisma\";\n\nconst DEMO_USER_EMAIL = \"demo@local\";\n\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\n  if (req.method !== \"GET\") return res.status(405).json({ error: \"Method not allowed\" });\n\n  try {\n    const q = (req.query.q as string) || \"\";\n    const sort = (req.query.sort as string) || \"desc\"; // by receivedAt\n\n    const user = await prisma.user.upsert({\n      where: { email: DEMO_USER_EMAIL },\n      update: {},\n      create: { email: DEMO_USER_EMAIL, name: \"Demo User\" },\n    });\n\n    const where = q\n      ? {\n          userId: user.id,\n          OR: [\n            { sender: { contains: q, mode: \"insensitive\" } },\n            { subject: { contains: q, mode: \"insensitive\" } },\n          ],\n        }\n      : { userId: user.id };\n\n    const emails = await prisma.email.findMany({\n      where,\n      orderBy: { receivedAt: sort === \"asc\" ? \"asc\" : \"desc\" },\n      take: 500,\n    });\n\n    return res.status(200).json({ ok: true, emails });\n  } catch (err) {\n    return res.status(500).json({ error: \"Server error\", details: String(err) });\n  }\n}"],"names":[],"mappings":";;;;AACA;;AAEA,MAAM,kBAAkB;AAET,eAAe,QAAQ,GAAmB,EAAE,GAAoB;IAC7E,IAAI,IAAI,MAAM,KAAK,OAAO,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,OAAO;IAAqB;IAEpF,IAAI;QACF,MAAM,IAAI,AAAC,IAAI,KAAK,CAAC,CAAC,IAAe;QACrC,MAAM,OAAO,AAAC,IAAI,KAAK,CAAC,IAAI,IAAe,QAAQ,gBAAgB;QAEnE,MAAM,OAAO,MAAM,uHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACpC,OAAO;gBAAE,OAAO;YAAgB;YAChC,QAAQ,CAAC;YACT,QAAQ;gBAAE,OAAO;gBAAiB,MAAM;YAAY;QACtD;QAEA,MAAM,QAAQ,IACV;YACE,QAAQ,KAAK,EAAE;YACf,IAAI;gBACF;oBAAE,QAAQ;wBAAE,UAAU;wBAAG,MAAM;oBAAc;gBAAE;gBAC/C;oBAAE,SAAS;wBAAE,UAAU;wBAAG,MAAM;oBAAc;gBAAE;aACjD;QACH,IACA;YAAE,QAAQ,KAAK,EAAE;QAAC;QAEtB,MAAM,SAAS,MAAM,uHAAM,CAAC,KAAK,CAAC,QAAQ,CAAC;YACzC;YACA,SAAS;gBAAE,YAAY,SAAS,QAAQ,QAAQ;YAAO;YACvD,MAAM;QACR;QAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,IAAI;YAAM;QAAO;IACjD,EAAE,OAAO,KAAK;QACZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;YAAgB,SAAS,OAAO;QAAK;IAC5E;AACF"}}]
}