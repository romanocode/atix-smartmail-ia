{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/carlo/Documents/Enter%20tech%20school/modulo301/atix-smartmail-ia/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: [\"error\", \"warn\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;QAAS;KAAO;AACxB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/carlo/Documents/Enter%20tech%20school/modulo301/atix-smartmail-ia/pages/api/emails/process.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from \"next\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { z } from \"zod\";\r\n\r\nconst BodySchema = z.object({\r\n  ids: z.array(z.string()).min(1),\r\n  processed: z.boolean(),\r\n});\r\n\r\nconst DEMO_USER_EMAIL = \"demo@local\";\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n  if (req.method !== \"POST\") return res.status(405).json({ error: \"Method not allowed\" });\r\n\r\n  const parsed = BodySchema.safeParse(req.body);\r\n  if (!parsed.success) return res.status(400).json({ error: \"Invalid body\", details: parsed.error.flatten() });\r\n\r\n  try {\r\n    const { ids, processed } = parsed.data;\r\n\r\n    const user = await prisma.user.upsert({\r\n      where: { email: DEMO_USER_EMAIL },\r\n      update: {},\r\n      create: { email: DEMO_USER_EMAIL, name: \"Demo User\" },\r\n    });\r\n\r\n    const result = await prisma.email.updateMany({\r\n      where: { userId: user.id, id: { in: ids } },\r\n      data: { processed },\r\n    });\r\n\r\n    return res.status(200).json({ ok: true, count: result.count });\r\n  } catch (err) {\r\n    return res.status(500).json({ error: \"Server error\", details: String(err) });\r\n  }\r\n}"],"names":[],"mappings":";;;;AACA;AACA;;;;;;;AAEA,MAAM,aAAa,2GAAC,CAAC,MAAM,CAAC;IAC1B,KAAK,2GAAC,CAAC,KAAK,CAAC,2GAAC,CAAC,MAAM,IAAI,GAAG,CAAC;IAC7B,WAAW,2GAAC,CAAC,OAAO;AACtB;AAEA,MAAM,kBAAkB;AAET,eAAe,QAAQ,GAAmB,EAAE,GAAoB;IAC7E,IAAI,IAAI,MAAM,KAAK,QAAQ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,OAAO;IAAqB;IAErF,MAAM,SAAS,WAAW,SAAS,CAAC,IAAI,IAAI;IAC5C,IAAI,CAAC,OAAO,OAAO,EAAE,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,OAAO;QAAgB,SAAS,OAAO,KAAK,CAAC,OAAO;IAAG;IAE1G,IAAI;QACF,MAAM,EAAE,GAAG,EAAE,SAAS,EAAE,GAAG,OAAO,IAAI;QAEtC,MAAM,OAAO,MAAM,uHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACpC,OAAO;gBAAE,OAAO;YAAgB;YAChC,QAAQ,CAAC;YACT,QAAQ;gBAAE,OAAO;gBAAiB,MAAM;YAAY;QACtD;QAEA,MAAM,SAAS,MAAM,uHAAM,CAAC,KAAK,CAAC,UAAU,CAAC;YAC3C,OAAO;gBAAE,QAAQ,KAAK,EAAE;gBAAE,IAAI;oBAAE,IAAI;gBAAI;YAAE;YAC1C,MAAM;gBAAE;YAAU;QACpB;QAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,IAAI;YAAM,OAAO,OAAO,KAAK;QAAC;IAC9D,EAAE,OAAO,KAAK;QACZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;YAAgB,SAAS,OAAO;QAAK;IAC5E;AACF"}}]
}